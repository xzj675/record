---
layout: post
title: HTTPS理解
category: 面试
tags: Interview
keywords: https,Interview
---
最近组内同事面试时被问了https相关的知识点，自己发现也不熟悉，就阅读了相关的文章[SSL/TLS协议运行机制的概述](http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html):  

HTTPS协议相比较与原有的HTTP主要是增加加密的功能，可以避免如下的情况
```
    1.通信内容被篡改
    2.通信内容被窃听
    3.伪造身份进行通讯
```
HTTPS主要使用的SSL/TLS协议
主要的通讯过程如下
```
    1.客户端与服务端通讯，获取证书，获取公匙
    2.客服端与服务端基于公匙生成会话密匙
    3.基于会话密匙双方进行对称加密通信
```

生成会话密匙主要经过如下四次握手阶段：

1.客户端发送开始通信信号，主要包括
```
* 支持的TLS版本
* 客户端随机生成的数字，用于生成会话密匙
* 支持的加密方法
* 支持的压缩算法
```
    
2.服务端受到客户端信号后
```
* 确认TLS版本，确定是否可以进行HTTPS通讯，如果不支持则直接终端通信
* 返回一个随机数，同样用于后续会话密匙
* 确定加密算法
* 服务器整数
```

3.客户端受到服务端信息，验证证书的权威，一般证书都是可信机构半部，如果非权威则浏览器会发出报警信息，由用户确定是否接受改证书，例如12306的证书
```
* 从证书中提取公匙，使用该公匙加密随机数发送到服务端，至此总共产生了3个随机数，基于这三个随机数，客服端和服务端使用商定的加密方法生成会话密匙
* 通知服务端编码改变，随后的加密信息使用双方协商的加密方法以及密匙通信
* 客户端握手结束，同时会发送一段之前发送所有内容的hash值，供服务端校验
```
    
4.服务端收到信号后
```
*  编码改变通知，随后的加密信息使用双方协商的加密方法以及密匙通信
* 服务端握手结束，同时会发送一段之前发送所有内容的hash值，供服务端校验
```
